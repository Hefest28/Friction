<!doctype html>
<html lang="bg">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> –ó–∞—è–≤–∫–∞</title>

  <!-- PWA –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2563eb">
  <link rel="apple-touch-icon" href="icon-192.png">

  <style>
    body {font-family: Arial, sans-serif; margin: 20px;}
    .item {
      display: flex;
      align-items: center;
      margin: 6px 0;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 6px 10px;
    }
    .item span {flex-grow: 1;}
    .item input[type="checkbox"] {margin-right: 8px;}
    .count {width: 60px; margin-right: 8px; text-align: center;}
    .delete-btn {
      background-color: #ff4b4b;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 4px 8px;
      cursor: pointer;
    }
    .delete-btn:hover {background-color: #d63838;}
    #summary {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    #newItem {padding: 5px;}
    button {padding: 6px 10px; border-radius: 6px; cursor: pointer;}
  </style>
</head>
<body>
  <h1>üìã –ó–∞—è–≤–∫–∞ </h1>

  <div id="list"></div>

  <div style="margin-top:10px;">
    <input id="newItem" type="text" placeholder="–î–æ–±–∞–≤–∏ –Ω–æ–≤ –µ–ª–µ–º–µ–Ω—Ç">
    <button onclick="addItem()">–î–æ–±–∞–≤–∏</button>
  </div>

  <script>
    let items = JSON.parse(localStorage.getItem("items") || "[]");

    function render() {
      const list = document.getElementById("list");
      list.innerHTML = "";

      items.forEach((item, i) => {
        const row = document.createElement("div");
        row.className = "item";
        row.innerHTML = `
          <input type="checkbox" ${item.checked ? "checked" : ""} onchange="toggle(${i})">
          <span>${item.name}</span>
          <input class="count" type="number" min="0" value="${item.count}" onchange="setCount(${i}, this.value)">
          <button class="delete-btn" onclick="deleteItem(${i})">üóë</button>
        `;
        list.appendChild(row);
      });

      updateSummary();
      localStorage.setItem("items", JSON.stringify(items));
    }

    function addItem() {
      const name = document.getElementById("newItem").value.trim();
      if (!name) return;
      items.push({ name, checked: false, count: 0 });
      document.getElementById("newItem").value = "";
      render();
    }

    function deleteItem(i) {
      if (confirm(`–°–∏–≥—É—Ä–µ–Ω –ª–∏ —Å–∏, —á–µ –∏—Å–∫–∞—à –¥–∞ –∏–∑—Ç—Ä–∏–µ—à "${items[i].name}"?`)) {
        items.splice(i, 1);
        render();
      }
    }

    function toggle(i) {
      items[i].checked = !items[i].checked;
      render();
    }

    function setCount(i, val) {
      items[i].count = parseInt(val) || 0;
      render();
    }

    function updateSummary() {
      let summary = items
        .filter(it => it.checked && it.count > 0)
        .map(it => `${it.name}: ${it.count} –±—Ä.`)
        .join("<br>");
    }

    render();

    // PWA service worker
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("service-worker.js");
    }
  </script>
</body>
</html>

